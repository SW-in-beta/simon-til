# 컨테이너 / 쿠버네티스

### 컨테이너 기술
- 로컬 기반 배포는 OS의 변경이 있을 때 리스크가 크다
- VM 기반 배포는 여러 OS를 띄워야하므로 무겁다
- 컨테이너 기반의 배포는 호스트 OS 위에 컨테이너 이미지들을 띄우는 것이므로 매우 가볍다 -> 확장이 쉽다
  - 트래픽이 많이 발생하는 서비스(조회 등)만 분리해서 확장할 수 있다.
  - 각각의 서비스를 격리된 환경에서 배포할 수 있다.
  - 배포하는 서비스가 컨테이너라는 단위로 표준화되어 사용하기 편리하다.

### 쿠버네티스
- 컨테이너 기반 위에서 컨테이너를 잘 다룰 수 있기 위해 탄생한 기술(Container Orchestration)
- 컨테이너의 유연한 특징을 최대한 활용해서 리소스를 절약하고 서비스를 안정적으로 운영할 수 있음
- 오토 스케일링 : 서비스의 트래픽이 각각 다를 때, 하나의 서버로 서비스의 컨테이너 수를 조절하면서 트래픽을 받아내도록 할 수 있다.
- 오토 힐링 : 장애가 발생했을 때(디스크 손상, 메모리 오버플로 등) 실개발환경에서는 서비스별로 백업 서버를 구성해야 하지만 컨테이너 환경에서는 하나의 서버로 장애가 발생한 서비스의 컨테이너를 띄워서 대응
#### 쿠버네티스의 객체
- 클러스터 -> 노드 -> Namespace로 세부화. 
- 파드(Pod) : 쿠버네티스의 가장 작은 컴퓨팅 단위. 주가 되는 컨테이너 하나로 구성. 이 안에서 실제 서비스가 실행되고 요청 처리
- 레플리카셋(ReplicaSet) : 다수의 Pod 관리. 트래픽에 따라 Pod 수를 조절하면서 서비스 제공 with autoscaler and autohealer. Pod에 붙은 label에 따라 pod 관리
- 디플로이먼트(Deployment) : 파드를 새로운 버전으로 업데이트. 다양한 배포 방식을 지원. ReplicaSet과 연결되어, Pod들을 관리. 기존의 Pod를 다 지우고 새로 만들 수도 있고(Recreate, 다 지워진 시간 동안 Downtime 발생 + 만약 새로 띄운 Pod가 망하면 Downtime이 무기한으로~), 새로운 버전의 Pod로 하나씩 대체하는 방식(Rolling Update) 등을 지원한다.
- 서비스 : Pod 그룹에 트래픽을 분산해서 전달 like loadbalancer.
- 인그레스(Ingress) : 내부에서 사용하는 주소 -> 주소에 따라 Service에 요청을 전달.
* IaC : Infra as Code -> 모든 쿠버네티스 오브젝트들은 코드로 작성된다. -> 구성 파일들만 있으면 코드로 동일한 환경을 구성할 수 있다. + 지속적으로 유지 보수가 가능하다.
* Image : 비유를 하자면 Image가 Class, Container가 Instance 라고 생각


# 크램폴린
